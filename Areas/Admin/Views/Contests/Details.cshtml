

@model HeThongQuanLyThi.Models.Contest
@{
    ViewData["Title"] = "Chi tiết cuộc thi";
}
<h1 class="text-2xl font-semibold mb-4">Chi tiết cuộc thi</h1>

<div class="bg-white rounded border p-4 mb-4">
  <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
    <div><span class="text-gray-500">Tiêu đề:</span> @Model.Title</div>
    <div><span class="text-gray-500">Môn:</span> @Model.Subject?.Name</div>
    <div><span class="text-gray-500">Thời gian:</span> @Model.StartAt.ToLocalTime() — @Model.EndAt?.ToLocalTime()</div>
    <div><span class="text-gray-500">Trạng thái:</span> @(Model.IsPublished ? "Đã phát hành" : "Nháp")</div>
    <div><span class="text-gray-500">Giới hạn/phút:</span> @Model.TimeLimitMinutes</div>
    <div><span class="text-gray-500">Lượt tối đa/HS:</span> @Model.MaxAttemptsPerStudent</div>
    <div><span class="text-gray-500">Xáo câu:</span> @(Model.ShuffleQuestions ? "Có" : "Không")</div>
    <div><span class="text-gray-500">Xáo đáp án:</span> @(Model.ShuffleChoices ? "Có" : "Không")</div>
  </div>
  @if (!string.IsNullOrWhiteSpace(Model.Description))
  {
    <div class="mt-3">
      <div class="text-gray-500">Mô tả</div>
      <div>@Model.Description</div>
    </div>
  }
</div>

<div class="bg-white rounded border p-4 mb-4">
  <h3 class="text-lg font-medium mb-2">Câu hỏi (@Model.Problems.Count)</h3>
  @if (Model.Problems?.Any() == true)
  {
    <ol class="list-decimal pl-6 space-y-2">
      @foreach (var cp in Model.Problems.OrderBy(x => x.Order))
      {
        <li>
          <div class="flex items-start justify-between gap-4">
            <div class="mr-4">@cp.Problem.Content</div>
            <div class="text-sm text-gray-600 whitespace-nowrap">
              Điểm: @(cp.PointsOverride?.ToString() ?? "—")
            </div>
          </div>
        </li>
      }
    </ol>
  }
  else
  {
    <p class="text-gray-500">Chưa có câu hỏi nào. Vào mục <em>Sửa</em> để chọn câu hỏi ngay trong form.</p>
  }
</div>

<div class="bg-white rounded border p-4">
  <h3 class="text-lg font-medium mb-2">Lượt làm (@Model.Attempts.Count)</h3>
  <p class="text-gray-500">Sẽ hiển thị chi tiết/điểm ở bản nâng cấp tiếp theo.</p>
</div>

<div class="mt-4 flex gap-2">
  <a asp-action="Edit" asp-route-id="@Model.Id" class="rounded border px-4 py-2 hover:bg-gray-50">Sửa</a>
  <a asp-action="Index" class="rounded border px-4 py-2 hover:bg-gray-50">Quay lại</a>
</div>