@model IEnumerable<HeThongQuanLyThi.Models.AdminUserListItemVm>
@{
    ViewData[index: "Title"] = "Quản lý người dùng";
}
<h1 class="text-2xl font-semibold mb-4">Quản lý người dùng</h1>

@if (TempData[key: "ok"] is string ok) { <div class="mb-3 rounded border border-green-200 bg-green-50 p-3 text-green-800">@ok</div> }
@if (TempData[key: "err"] is string err) { <div class="mb-3 rounded border border-red-200 bg-red-50 p-3 text-red-800">@err</div> }

<form method="get" class="mb-4 flex gap-2">
    <input name="q" value="@((string?)ViewBag.Query)" placeholder="Tìm email/username..."
           class="w-80 rounded border border-gray-300 p-2" />
    <button class="rounded bg-indigo-600 px-4 py-2 text-white">Tìm</button>
    <a asp-action="Create" class="ml-auto rounded border px-4 py-2 hover:bg-gray-50">Tạo người dùng</a>
</form>

<div class="overflow-x-auto">
<table class="min-w-full border border-gray-200">
  <thead class="bg-gray-50">
    <tr>
      <th class="p-2 text-left">Email</th>
      <th class="p-2 text-left">Username</th>
      <th class="p-2 text-left">Roles</th>
      <th class="p-2 text-left">Lockout</th>
      <th class="p-2"></th>
    </tr>
  </thead>
  <tbody>
  @foreach (AdminUserListItemVm u in Model)
  {
    <tr class="border-t">
      <td class="p-2">@u.Email</td>
      <td class="p-2">@u.UserName</td>
      <td class="p-2">@string.Join(separator: ", ", u.Roles)</td>
      <td class="p-2">
        @(u.IsLockedOut ? $"Locked until {u.LockoutEnd:u}" : "—")
      </td>
      <td class="p-2 text-right">
        <a asp-action="Details" asp-route-id="@u.Id" class="text-indigo-600 hover:underline mr-2">Xem</a>
        <a asp-action="Edit" asp-route-id="@u.Id" class="text-amber-600 hover:underline mr-2">Sửa</a>
        <a asp-action="Delete" asp-route-id="@u.Id" class="text-red-600 hover:underline">Xoá</a>
      </td>
    </tr>
  }
  </tbody>
</table>
</div>